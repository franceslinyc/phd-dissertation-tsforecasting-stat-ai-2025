# Overview of MCMC Algorithms {#sec-ch1-comp}

The full Bayesian model is completed by the specification of prior distributions for the parameters $\alpha$, $\beta$, $\boldsymbol{\rho}$, and $\boldsymbol{w}$, where $\alpha$ and $\beta$ are parameters of the gamma marginals, and $\boldsymbol{\rho}$ and $\boldsymbol{w}$ are the dependence and weight parameters, respectively. For the copula-based Gamma MTD model, the priors are specified as $Gamma(\alpha | u_{\alpha}, v_{\alpha})$, $Gamma(\beta | u_{\beta}, v_{\beta})$, and $Unif(\rho_l |-1, 1)$. For the cdf-based weights, the prior is $CDP(\boldsymbol{w} | \alpha_0, a_0, b_0)$.

The parameters $\alpha$, $\beta$, and $\boldsymbol{\rho}$ are updated using a slice sampler [@neal2003slice]. Following the definition in Equation \ref{eq:cond_distribution_copula}, denote $f_l (x_t | x_{t-l})$ as $f_l (x_t | x_{t-l}) = c_l (x_t, x_{t-l}) f_X(x_t)$, where $f_l$ is the transition kernel, $c_l$ is the copula density, and $f_X$ is the stationary marginal density. The posterior full conditional distributions for the marginal parameters $\alpha$ and $\beta$ are proportional to $Gamma(\alpha | u_{\alpha}, v_{\alpha}) \prod_{t=L+1}^n f_l (x_t | x_{t-l})$ and $Gamma(\beta | u_{\beta}, v_{\beta})$ $\prod_{t=L+1}^n f_l (x_t | x_{t-l})$, respectively. The posterior full conditional distribution for each of the dependence parameters $\boldsymbol{\rho}$ is proportional to $Unif(\rho_l |-1, 1) \prod_{t:z_t = l} c_l (x_t, x_{t-l})$. 

For the latent variables ${\{z_t\}}_{t=L+1}^n$, the posterior full conditional for each $z_t$ is a discrete distribution on $\{1, ..., L\}$, where the probability of $z_t = l$, denoted by 
$q_l$, is proportional to $w_l c_l (x_t, x_{t-l})$, for $l = 1,..., L$. The posterior full conditional distribution for weight parameters $\boldsymbol{w}$, under the cdf-based prior, is $Dirichlet (\boldsymbol{\alpha})$, where $\boldsymbol{\alpha} = (\alpha_0 a_1 + M_1, ..., \alpha_0 a_L + M_L)$.  

The MCMC algorithm, adapted from Zheng's source code for the MTD model [@zheng2022construction], is written in $\texttt{R}$, with certain functions written in $\texttt{C++}$. Algorithm 1 (@fig-alg) requires data, mtd order, hyperparameters of the priors for $\alpha$, $\beta$, $\boldsymbol{w}$, and starting values for $\alpha$, $\beta$, $\boldsymbol{\rho}$. It also requires tuning parameters for the slice sampler, including step size and upper bounds for $\alpha$ and $\beta$, along with the general MCMC settings such as number of iterations, burn-in period, and thinning interval. The algorithm outputs posterior samples of $\alpha$, $\beta$, $\boldsymbol{\rho}$ and $\boldsymbol{w}$. Asterisk (*) denotes steps that differ from of the algorithm by @zheng2022construction.

![MCMC Algorithm for Parameter Estimation for Gamma MTD Models](../images/chapter1/alg-1-3.png){#fig-alg fig-alt="MCMC steps used to estimate parameters in Gamma MTD models"}

  